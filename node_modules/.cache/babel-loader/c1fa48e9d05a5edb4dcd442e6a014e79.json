{"remainingRequest":"C:\\xampp\\htdocs\\GulflamarERPSystem\\frontend\\node_modules\\thread-loader\\dist\\cjs.js!C:\\xampp\\htdocs\\GulflamarERPSystem\\frontend\\node_modules\\babel-loader\\lib\\index.js!C:\\xampp\\htdocs\\GulflamarERPSystem\\frontend\\src\\@core\\auth\\jwt\\jwtService.js","dependencies":[{"path":"C:\\xampp\\htdocs\\GulflamarERPSystem\\frontend\\src\\@core\\auth\\jwt\\jwtService.js","mtime":1658909893000},{"path":"C:\\xampp\\htdocs\\GulflamarERPSystem\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1658911406787},{"path":"C:\\xampp\\htdocs\\GulflamarERPSystem\\frontend\\node_modules\\thread-loader\\dist\\cjs.js","mtime":1658911406916},{"path":"C:\\xampp\\htdocs\\GulflamarERPSystem\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":1658911406756}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiQzoveGFtcHAvaHRkb2NzL0d1bGZsYW1hckVSUFN5c3RlbS9mcm9udGVuZC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vb2JqZWN0U3ByZWFkMiI7CmltcG9ydCBfY2xhc3NDYWxsQ2hlY2sgZnJvbSAiQzoveGFtcHAvaHRkb2NzL0d1bGZsYW1hckVSUFN5c3RlbS9mcm9udGVuZC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY2xhc3NDYWxsQ2hlY2siOwppbXBvcnQgX2NyZWF0ZUNsYXNzIGZyb20gIkM6L3hhbXBwL2h0ZG9jcy9HdWxmbGFtYXJFUlBTeXN0ZW0vZnJvbnRlbmQvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZUNsYXNzIjsKaW1wb3J0IF9kZWZpbmVQcm9wZXJ0eSBmcm9tICJDOi94YW1wcC9odGRvY3MvR3VsZmxhbWFyRVJQU3lzdGVtL2Zyb250ZW5kL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9kZWZpbmVQcm9wZXJ0eSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmNvbmNhdC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5maWx0ZXIuanMiOwppbXBvcnQgVnVlIGZyb20gJ3Z1ZSc7CmltcG9ydCB7IGluaXRpYWxBYmlsaXR5IH0gZnJvbSAnQC9saWJzL2FjbC9jb25maWcnOwppbXBvcnQgcm91dGVyIGZyb20gJ0Avcm91dGVyJzsKaW1wb3J0IGF4aW9zIGZyb20gJ2F4aW9zJzsKaW1wb3J0IGp3dERlZmF1bHRDb25maWcgZnJvbSAnLi9qd3REZWZhdWx0Q29uZmlnJzsKCnZhciBKd3RTZXJ2aWNlID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICAvLyBXaWxsIGJlIHVzZWQgYnkgdGhpcyBzZXJ2aWNlIGZvciBtYWtpbmcgQVBJIGNhbGxzCiAgLy8gand0Q29uZmlnIDw9IFdpbGwgYmUgdXNlZCBieSB0aGlzIHNlcnZpY2UKICAvLyBGb3IgUmVmcmVzaGluZyBUb2tlbgogIC8vIEZvciBSZWZyZXNoaW5nIFRva2VuCiAgZnVuY3Rpb24gSnd0U2VydmljZShheGlvc0lucywgand0T3ZlcnJpZGVDb25maWcpIHsKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEp3dFNlcnZpY2UpOwoKICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiYXhpb3NJbnMiLCBudWxsKTsKCiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgImp3dENvbmZpZyIsIF9vYmplY3RTcHJlYWQoe30sIGp3dERlZmF1bHRDb25maWcpKTsKCiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgImlzQWxyZWFkeUZldGNoaW5nQWNjZXNzVG9rZW4iLCBmYWxzZSk7CgogICAgX2RlZmluZVByb3BlcnR5KHRoaXMsICJzdWJzY3JpYmVycyIsIFtdKTsKCiAgICB0aGlzLmF4aW9zSW5zID0gYXhpb3NJbnM7CiAgICB0aGlzLmp3dENvbmZpZyA9IF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgdGhpcy5qd3RDb25maWcpLCBqd3RPdmVycmlkZUNvbmZpZyk7IC8vIFJlcXVlc3QgSW50ZXJjZXB0b3IKCiAgICB0aGlzLmF4aW9zSW5zLmludGVyY2VwdG9ycy5yZXF1ZXN0LnVzZShmdW5jdGlvbiAoY29uZmlnKSB7CiAgICAgIC8vIEdldCB0b2tlbiBmcm9tIGxvY2FsU3RvcmFnZQogICAgICB2YXIgYWNjZXNzVG9rZW4gPSBfdGhpcy5nZXRUb2tlbigpOyAvLyBJZiB0b2tlbiBpcyBwcmVzZW50IGFkZCBpdCB0byByZXF1ZXN0J3MgQXV0aG9yaXphdGlvbiBIZWFkZXIKCgogICAgICBpZiAoYWNjZXNzVG9rZW4pIHsKICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcGFyYW0tcmVhc3NpZ24KICAgICAgICBjb25maWcuaGVhZGVycy5BdXRob3JpemF0aW9uID0gIiIuY29uY2F0KF90aGlzLmp3dENvbmZpZy50b2tlblR5cGUsICIgIikuY29uY2F0KGFjY2Vzc1Rva2VuKTsgLy8gY29uZmlnLmhlYWRlcnMuQ29udGVudC1UeXBlID0gYG11bHRpcGFydC9mb3JtLWRhdGFgCiAgICAgIH0KCiAgICAgIHJldHVybiBjb25maWc7CiAgICB9LCBmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycm9yKTsKICAgIH0pOyAvLyBBZGQgcmVxdWVzdC9yZXNwb25zZSBpbnRlcmNlcHRvcgoKICAgIHRoaXMuYXhpb3NJbnMuaW50ZXJjZXB0b3JzLnJlc3BvbnNlLnVzZShmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgcmV0dXJuIHJlc3BvbnNlOwogICAgfSwgZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgIC8vIGNvbnN0IHsgY29uZmlnLCByZXNwb25zZTogeyBzdGF0dXMgfSB9ID0gZXJyb3IKICAgICAgdmFyIGNvbmZpZyA9IGVycm9yLmNvbmZpZywKICAgICAgICAgIHJlc3BvbnNlID0gZXJyb3IucmVzcG9uc2U7CiAgICAgIHZhciBvcmlnaW5hbFJlcXVlc3QgPSBjb25maWc7CgogICAgICBpZiAoIV90aGlzLmlzQWxyZWFkeUZldGNoaW5nQWNjZXNzVG9rZW4pIHsKICAgICAgICBfdGhpcy5pc0FscmVhZHlGZXRjaGluZ0FjY2Vzc1Rva2VuID0gdHJ1ZTsKCiAgICAgICAgX3RoaXMucmVmcmVzaFRva2VuKCkudGhlbihmdW5jdGlvbiAocikgewogICAgICAgICAgX3RoaXMuaXNBbHJlYWR5RmV0Y2hpbmdBY2Nlc3NUb2tlbiA9IGZhbHNlOyAvLyBVcGRhdGUgYWNjZXNzVG9rZW4gaW4gbG9jYWxTdG9yYWdlCgogICAgICAgICAgX3RoaXMuc2V0VG9rZW4oci5kYXRhLmFjY2Vzc190b2tlbik7CgogICAgICAgICAgX3RoaXMuc2V0UmVmcmVzaFRva2VuKHIuZGF0YS5hY2Nlc3NfdG9rZW4pOwoKICAgICAgICAgIF90aGlzLm9uQWNjZXNzVG9rZW5GZXRjaGVkKHIuZGF0YS5hY2Nlc3NfdG9rZW4pOwogICAgICAgIH0pOwogICAgICB9IC8vIGlmIChzdGF0dXMgPT09IDQwMSkgewoKCiAgICAgIGlmIChyZXNwb25zZSAmJiByZXNwb25zZS5zdGF0dXMgPT09IDQwMSkgewogICAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKF90aGlzLmp3dENvbmZpZy5zdG9yYWdlVG9rZW5LZXlOYW1lKTsKICAgICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShfdGhpcy5qd3RDb25maWcuc3RvcmFnZVJlZnJlc2hUb2tlbktleU5hbWUpOyAvLyBSZW1vdmUgdXNlckRhdGEgZnJvbSBsb2NhbFN0b3JhZ2UKCiAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ3VzZXJEYXRhJyk7IC8vIFJlc2V0IGFiaWxpdHkKICAgICAgICAvLyB0aGlzLiRhYmlsaXR5LnVwZGF0ZShpbml0aWFsQWJpbGl0eSkKICAgICAgICAvLyBSZWRpcmVjdCB0byBsb2dpbiBwYWdlCgogICAgICAgIF90aGlzLiRyb3V0ZXIucHVzaCh7CiAgICAgICAgICBuYW1lOiAnYXV0aC1sb2dpbicKICAgICAgICB9KTsKICAgICAgICAvKiBjb25zdCByZXRyeU9yaWdpbmFsUmVxdWVzdCA9IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gewogICAgICAgICAgdGhpcy5hZGRTdWJzY3JpYmVyKGFjY2Vzc1Rva2VuID0+IHsKICAgICAgICAgICAgLy8gTWFrZSBzdXJlIHRvIGFzc2lnbiBhY2Nlc3NUb2tlbiBhY2NvcmRpbmcgdG8geW91ciByZXNwb25zZS4KICAgICAgICAgICAgLy8gQ2hlY2s6IGh0dHBzOi8vcGl4aW52ZW50LnRpY2tzeS5jb20vdGlja2V0LzI0MTM4NzAKICAgICAgICAgICAgLy8gQ2hhbmdlIEF1dGhvcml6YXRpb24gaGVhZGVyCiAgICAgICAgICAgIG9yaWdpbmFsUmVxdWVzdC5oZWFkZXJzLkF1dGhvcml6YXRpb24gPSBgJHt0aGlzLmp3dENvbmZpZy50b2tlblR5cGV9ICR7YWNjZXNzVG9rZW59YAogICAgICAgICAgICByZXNvbHZlKHRoaXMuYXhpb3NJbnMob3JpZ2luYWxSZXF1ZXN0KSkKICAgICAgICAgIH0pCiAgICAgICAgfSkKICAgICAgICByZXR1cm4gcmV0cnlPcmlnaW5hbFJlcXVlc3QgKi8KCiAgICAgIH0KCiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlcnJvcik7CiAgICB9KTsKICB9CgogIF9jcmVhdGVDbGFzcyhKd3RTZXJ2aWNlLCBbewogICAga2V5OiAib25BY2Nlc3NUb2tlbkZldGNoZWQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9uQWNjZXNzVG9rZW5GZXRjaGVkKGFjY2Vzc1Rva2VuKSB7CiAgICAgIHRoaXMuc3Vic2NyaWJlcnMgPSB0aGlzLnN1YnNjcmliZXJzLmZpbHRlcihmdW5jdGlvbiAoY2FsbGJhY2spIHsKICAgICAgICByZXR1cm4gY2FsbGJhY2soYWNjZXNzVG9rZW4pOwogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJhZGRTdWJzY3JpYmVyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBhZGRTdWJzY3JpYmVyKGNhbGxiYWNrKSB7CiAgICAgIHRoaXMuc3Vic2NyaWJlcnMucHVzaChjYWxsYmFjayk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0VG9rZW4iLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldFRva2VuKCkgewogICAgICByZXR1cm4gbG9jYWxTdG9yYWdlLmdldEl0ZW0odGhpcy5qd3RDb25maWcuc3RvcmFnZVRva2VuS2V5TmFtZSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0UmVmcmVzaFRva2VuIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRSZWZyZXNoVG9rZW4oKSB7CiAgICAgIHJldHVybiBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSh0aGlzLmp3dENvbmZpZy5zdG9yYWdlUmVmcmVzaFRva2VuS2V5TmFtZSk7CiAgICB9CiAgfSwgewogICAga2V5OiAic2V0VG9rZW4iLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldFRva2VuKHZhbHVlKSB7CiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKHRoaXMuand0Q29uZmlnLnN0b3JhZ2VUb2tlbktleU5hbWUsIHZhbHVlKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzZXRSZWZyZXNoVG9rZW4iLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldFJlZnJlc2hUb2tlbih2YWx1ZSkgewogICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSh0aGlzLmp3dENvbmZpZy5zdG9yYWdlUmVmcmVzaFRva2VuS2V5TmFtZSwgdmFsdWUpOwogICAgfQogIH0sIHsKICAgIGtleTogImxvZ2luIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBsb2dpbigpIHsKICAgICAgdmFyIF90aGlzJGF4aW9zSW5zOwoKICAgICAgZm9yICh2YXIgX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkoX2xlbiksIF9rZXkgPSAwOyBfa2V5IDwgX2xlbjsgX2tleSsrKSB7CiAgICAgICAgYXJnc1tfa2V5XSA9IGFyZ3VtZW50c1tfa2V5XTsKICAgICAgfQoKICAgICAgcmV0dXJuIChfdGhpcyRheGlvc0lucyA9IHRoaXMuYXhpb3NJbnMpLnBvc3QuYXBwbHkoX3RoaXMkYXhpb3NJbnMsIFt0aGlzLmp3dENvbmZpZy5sb2dpbkVuZHBvaW50XS5jb25jYXQoYXJncykpOwogICAgfQogIH0sIHsKICAgIGtleTogInNldFBlcm1pc3Npb25zIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRQZXJtaXNzaW9ucygpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICBheGlvcy5nZXQoJy9nZXRQZXJtaXNzaW9ucycpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgY29uc29sZS5sb2coJ3Jlc3BvbnNlJywgcmVzcG9uc2UuZGF0YS5kYXRhKTsKICAgICAgICB2YXIgdXNlciA9IHJlc3BvbnNlLmRhdGEuZGF0YTsKICAgICAgICB2YXIgdXNlckRhdGEgPSB1c2VyOwoKICAgICAgICBfdGhpczIuJGFiaWxpdHkudXBkYXRlKHVzZXJEYXRhLmFiaWxpdHkpOwogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yKTsKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAicmVnaXN0ZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlZ2lzdGVyKCkgewogICAgICB2YXIgX3RoaXMkYXhpb3NJbnMyOwoKICAgICAgZm9yICh2YXIgX2xlbjIgPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4yKSwgX2tleTIgPSAwOyBfa2V5MiA8IF9sZW4yOyBfa2V5MisrKSB7CiAgICAgICAgYXJnc1tfa2V5Ml0gPSBhcmd1bWVudHNbX2tleTJdOwogICAgICB9CgogICAgICByZXR1cm4gKF90aGlzJGF4aW9zSW5zMiA9IHRoaXMuYXhpb3NJbnMpLnBvc3QuYXBwbHkoX3RoaXMkYXhpb3NJbnMyLCBbdGhpcy5qd3RDb25maWcucmVnaXN0ZXJFbmRwb2ludF0uY29uY2F0KGFyZ3MpKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZWZyZXNoVG9rZW4iLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlZnJlc2hUb2tlbigpIHsKICAgICAgcmV0dXJuIHRoaXMuYXhpb3NJbnMucG9zdCh0aGlzLmp3dENvbmZpZy5yZWZyZXNoRW5kcG9pbnQsIHsKICAgICAgICByZWZyZXNoVG9rZW46IHRoaXMuZ2V0UmVmcmVzaFRva2VuKCkKICAgICAgfSk7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gSnd0U2VydmljZTsKfSgpOwoKZXhwb3J0IHsgSnd0U2VydmljZSBhcyBkZWZhdWx0IH07"},{"version":3,"sources":["C:/xampp/htdocs/GulflamarERPSystem/frontend/src/@core/auth/jwt/jwtService.js"],"names":["Vue","initialAbility","router","axios","jwtDefaultConfig","JwtService","axiosIns","jwtOverrideConfig","jwtConfig","interceptors","request","use","config","accessToken","getToken","headers","Authorization","tokenType","error","Promise","reject","response","originalRequest","isAlreadyFetchingAccessToken","refreshToken","then","r","setToken","data","access_token","setRefreshToken","onAccessTokenFetched","status","localStorage","removeItem","storageTokenKeyName","storageRefreshTokenKeyName","$router","push","name","subscribers","filter","callback","getItem","value","setItem","args","post","loginEndpoint","get","console","log","user","userData","$ability","update","ability","catch","registerEndpoint","refreshEndpoint","getRefreshToken"],"mappings":"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","sourcesContent":["import Vue from 'vue'\nimport { initialAbility } from '@/libs/acl/config'\nimport router from '@/router'\nimport axios from 'axios'\nimport jwtDefaultConfig from './jwtDefaultConfig'\n\nexport default class JwtService {\n  // Will be used by this service for making API calls\n  axiosIns = null\n\n  // jwtConfig <= Will be used by this service\n  jwtConfig = { ...jwtDefaultConfig }\n\n  // For Refreshing Token\n  isAlreadyFetchingAccessToken = false\n\n  // For Refreshing Token\n  subscribers = []\n\n  constructor(axiosIns, jwtOverrideConfig) {\n    this.axiosIns = axiosIns\n    this.jwtConfig = { ...this.jwtConfig, ...jwtOverrideConfig }\n\n    // Request Interceptor\n    this.axiosIns.interceptors.request.use(\n      config => {\n        // Get token from localStorage\n        const accessToken = this.getToken()\n\n        // If token is present add it to request's Authorization Header\n        if (accessToken) {\n          // eslint-disable-next-line no-param-reassign\n          config.headers.Authorization = `${this.jwtConfig.tokenType} ${accessToken}`\n          // config.headers.Content-Type = `multipart/form-data`\n        }\n        return config\n      },\n      error => Promise.reject(error),\n    )\n\n    // Add request/response interceptor\n    this.axiosIns.interceptors.response.use(\n      response => response,\n      error => {\n        // const { config, response: { status } } = error\n        const { config, response } = error\n        const originalRequest = config\n\n        if (!this.isAlreadyFetchingAccessToken) {\n          this.isAlreadyFetchingAccessToken = true\n          this.refreshToken().then(r => {\n            this.isAlreadyFetchingAccessToken = false\n\n            // Update accessToken in localStorage\n            this.setToken(r.data.access_token)\n            this.setRefreshToken(r.data.access_token)\n\n            this.onAccessTokenFetched(r.data.access_token)\n          })\n        }\n\n        // if (status === 401) {\n        if (response && response.status === 401) {\n          localStorage.removeItem(this.jwtConfig.storageTokenKeyName)\n          localStorage.removeItem(this.jwtConfig.storageRefreshTokenKeyName)\n\n          // Remove userData from localStorage\n          localStorage.removeItem('userData')\n\n          // Reset ability\n          // this.$ability.update(initialAbility)\n\n          // Redirect to login page\n          this.$router.push({ name: 'auth-login' })\n\n          /* const retryOriginalRequest = new Promise(resolve => {\n            this.addSubscriber(accessToken => {\n              // Make sure to assign accessToken according to your response.\n              // Check: https://pixinvent.ticksy.com/ticket/2413870\n              // Change Authorization header\n              originalRequest.headers.Authorization = `${this.jwtConfig.tokenType} ${accessToken}`\n              resolve(this.axiosIns(originalRequest))\n            })\n          })\n          return retryOriginalRequest */\n        }\n        return Promise.reject(error)\n      },\n    )\n  }\n\n  onAccessTokenFetched(accessToken) {\n    this.subscribers = this.subscribers.filter(callback => callback(accessToken))\n  }\n\n  addSubscriber(callback) {\n    this.subscribers.push(callback)\n  }\n\n  getToken() {\n    return localStorage.getItem(this.jwtConfig.storageTokenKeyName)\n  }\n\n  getRefreshToken() {\n    return localStorage.getItem(this.jwtConfig.storageRefreshTokenKeyName)\n  }\n\n  setToken(value) {\n    localStorage.setItem(this.jwtConfig.storageTokenKeyName, value)\n  }\n\n  setRefreshToken(value) {\n    localStorage.setItem(this.jwtConfig.storageRefreshTokenKeyName, value)\n  }\n\n  login(...args) {\n    return this.axiosIns.post(this.jwtConfig.loginEndpoint, ...args)\n  }\n\n  setPermissions() {\n    axios.get('/getPermissions')\n\n      .then(response => {\n        console.log('response', response.data.data)\n        const user = response.data.data\n        const userData = user\n        this.$ability.update(userData.ability)\n      }).catch(error => {\n        console.error(error)\n      })\n  }\n\n  register(...args) {\n    return this.axiosIns.post(this.jwtConfig.registerEndpoint, ...args)\n  }\n\n  refreshToken() {\n    return this.axiosIns.post(this.jwtConfig.refreshEndpoint, {\n      refreshToken: this.getRefreshToken(),\n    })\n  }\n}\n"]}]}