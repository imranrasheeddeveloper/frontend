var de=Object.defineProperty;var F=Object.getOwnPropertySymbols;var ce=Object.prototype.hasOwnProperty,pe=Object.prototype.propertyIsEnumerable;var j=(d,o,h)=>o in d?de(d,o,{enumerable:!0,configurable:!0,writable:!0,value:h}):d[o]=h,B=(d,o)=>{for(var h in o||(o={}))ce.call(o,h)&&j(d,h,o[h]);if(F)for(var h of F(o))pe.call(o,h)&&j(d,h,o[h]);return d};(function(d,o){typeof exports=="object"&&typeof module!="undefined"?o(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],o):(d=typeof globalThis!="undefined"?globalThis:d||self,o(d["@lob/vue-address-autocomplete"]={},d.Vue))})(this,function(d,o){"use strict";var h="",T=(e,t)=>{const s=e.__vccOpts||e;for(const[l,a]of t)s[l]=a;return s};const P=o.defineComponent({name:"TypeAhead",emits:["onInput","onFocus","onBlur","onSelect","update:modelValue"],props:{id:{type:String},placeholder:{type:String,default:""},items:{type:Array,required:!0},defaultItem:{default:null},itemProjection:{type:Function,default(e){return{suggestion:e,input:e}}},minInputLength:{type:Number,default:2,validator:e=>e>=0},label:{type:String,default:null},modelValue:{type:String,default:""},isLabelFloating:{type:Boolean,default:!1}},mounted(){this.defaultItem!==void 0&&this.defaultItem!==null&&this.selectItem(this.defaultItem)},data(){return{inputId:this.id||`simple_typeahead_${(Math.random()*1e3).toFixed()}`,isInputFocused:!1,currentSelectionIndex:0}},methods:{onInput(e){this.isListVisible&&this.currentSelectionIndex>=this.filteredItems.length&&(this.currentSelectionIndex=(this.filteredItems.length||1)-1),this.$emit("onInput",{input:this.modelValue,items:this.filteredItems}),this.$emit("update:modelValue",e.target.value)},onFocus(){this.isInputFocused=!0,this.$emit("onFocus",{input:this.modelValue,items:this.filteredItems})},onBlur(){this.isInputFocused=!1,this.$emit("onBlur",{input:this.modelValue,items:this.filteredItems})},onArrowDown(e){this.isListVisible&&this.currentSelectionIndex<this.filteredItems.length-1&&this.currentSelectionIndex++,this.scrollSelectionIntoView()},onArrowUp(e){this.isListVisible&&this.currentSelectionIndex>0&&this.currentSelectionIndex--,this.scrollSelectionIntoView()},scrollSelectionIntoView(){setTimeout(()=>{const e=document.querySelector(`#${this.wrapperId} .lob-typeahead-list`),t=document.querySelector(`#${this.wrapperId} .lob-typeahead-list-item.lob-typeahead-list-item-active`);if(!!t&&!(t.offsetTop>=e.scrollTop&&t.offsetTop+t.offsetHeight<e.scrollTop+e.offsetHeight)){let s=0;t.offsetTop>e.scrollTop?s=t.offsetTop+t.offsetHeight-e.offsetHeight:t.offsetTop<e.scrollTop&&(s=t.offsetTop),e.scrollTo(0,s)}})},selectCurrentSelection(){this.currentSelection&&this.selectItem(this.currentSelection)},selectItem(e){var t;this.$emit("update:modelValue",this.itemProjection(e).input),this.$emit("onSelect",e),this.currentSelectionIndex=0,(t=document.getElementById(this.inputId))==null||t.blur(),this.isInputFocused=!1},escapeRegExp(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")},boldMatchText(e){const t=new RegExp(`(${this.escapeRegExp(this.modelValue)})`,"ig");return e.replace(t,"<strong>$1</strong>")}},computed:{wrapperId(){return`${this.inputId}_wrapper`},filteredItems(){return this.items||[]},isListVisible(){const e=this.modelValue.length>=this.minInputLength;return this.isInputFocused&&e&&this.filteredItems.length},currentSelection(){return this.isListVisible&&this.currentSelectionIndex<this.filteredItems.length?this.filteredItems[this.currentSelectionIndex]:void 0},inputValue:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e)}}}}),L=["id"],O=["for"],N=["id","placeholder"],M={key:1,class:"lob-typeahead-list"},H={key:0},x=["onClick","onMouseenter"],z=["data-text"],U=["data-text","innerHTML"],R={key:1};function D(e,t,s,l,a,i){return o.openBlock(),o.createElementBlock("div",{id:e.wrapperId,class:"lob-typeahead-root"},[e.label?(o.openBlock(),o.createElementBlock("label",{key:0,for:e.inputId,class:o.normalizeClass(["lob-typeahead-label",e.isLabelFloating?"lob-typeahead-label-floating":"lob-typeahead-label-absolute"])},o.toDisplayString(e.label),11,O)):o.createCommentVNode("",!0),o.withDirectives(o.createElementVNode("input",{id:e.inputId,class:o.normalizeClass(["lob-typeahead-input",e.label&&!e.isLabelFloating&&"lob-typeahead-input-with-label"]),type:"text",placeholder:e.placeholder,"onUpdate:modelValue":t[0]||(t[0]=n=>e.inputValue=n),onInput:t[1]||(t[1]=(...n)=>e.onInput&&e.onInput(...n)),onFocus:t[2]||(t[2]=(...n)=>e.onFocus&&e.onFocus(...n)),onBlur:t[3]||(t[3]=(...n)=>e.onBlur&&e.onBlur(...n)),onKeydown:[t[4]||(t[4]=o.withKeys(o.withModifiers((...n)=>e.onArrowDown&&e.onArrowDown(...n),["prevent"]),["down"])),t[5]||(t[5]=o.withKeys(o.withModifiers((...n)=>e.onArrowUp&&e.onArrowUp(...n),["prevent"]),["up"])),t[6]||(t[6]=o.withKeys((...n)=>e.selectCurrentSelection&&e.selectCurrentSelection(...n),["enter","tab"]))],autocomplete:"off"},null,42,N),[[o.vModelText,e.inputValue]]),e.isListVisible?(o.openBlock(),o.createElementBlock("div",M,[e.$slots["list-header"]?(o.openBlock(),o.createElementBlock("div",H,[o.renderSlot(e.$slots,"list-header")])):o.createCommentVNode("",!0),(o.openBlock(!0),o.createElementBlock(o.Fragment,null,o.renderList(e.filteredItems,(n,c)=>(o.openBlock(),o.createElementBlock("div",{class:o.normalizeClass(["lob-typeahead-list-item",{"lob-typeahead-list-item-active":e.currentSelectionIndex==c}]),key:c,onMousedown:t[7]||(t[7]=o.withModifiers(()=>{},["prevent"])),onClick:p=>e.selectItem(n),onMouseenter:p=>e.currentSelectionIndex=c},[e.$slots["list-item-text"]?(o.openBlock(),o.createElementBlock("span",{key:0,class:"lob-typeahead-list-item-text","data-text":e.itemProjection(n).suggestion},[o.renderSlot(e.$slots,"list-item-text",{item:n,itemProjection:e.itemProjection})],8,z)):(o.openBlock(),o.createElementBlock("span",{key:1,class:"lob-typeahead-list-item-text","data-text":e.itemProjection(n).input,innerHTML:e.itemProjection(n).suggestion},null,8,U))],42,x))),128)),e.$slots["list-footer"]?(o.openBlock(),o.createElementBlock("div",R,[o.renderSlot(e.$slots,"list-footer")])):o.createCommentVNode("",!0)])):o.createCommentVNode("",!0)],8,L)}var J=T(P,[["render",D]]),V=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},v={exports:{}};/*! https://mths.be/base64 v1.0.0 by @mathias | MIT license */(function(e,t){(function(s){var l=t,a=e&&e.exports==l&&e,i=typeof V=="object"&&V;(i.global===i||i.window===i)&&(s=i);var n=function(r){this.message=r};n.prototype=new Error,n.prototype.name="InvalidCharacterError";var c=function(r){throw new n(r)},p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ie=/[\t\n\f\r ]/g,re=function(r){r=String(r).replace(ie,"");var f=r.length;f%4==0&&(r=r.replace(/==?$/,""),f=r.length),(f%4==1||/[^+a-zA-Z0-9/]/.test(r))&&c("Invalid character: the string to be decoded is not correctly encoded.");for(var g=0,m,y,b="",w=-1;++w<f;)y=p.indexOf(r.charAt(w)),m=g%4?m*64+y:y,g++%4&&(b+=String.fromCharCode(255&m>>(-2*g&6)));return b},le=function(r){r=String(r),/[^\0-\xFF]/.test(r)&&c("The string to be encoded contains characters outside of the Latin1 range.");for(var f=r.length%3,g="",m=-1,y,b,w,u,ae=r.length-f;++m<ae;)y=r.charCodeAt(m)<<16,b=r.charCodeAt(++m)<<8,w=r.charCodeAt(++m),u=y+b+w,g+=p.charAt(u>>18&63)+p.charAt(u>>12&63)+p.charAt(u>>6&63)+p.charAt(u&63);return f==2?(y=r.charCodeAt(m)<<8,b=r.charCodeAt(++m),u=y+b,g+=p.charAt(u>>10)+p.charAt(u>>4&63)+p.charAt(u<<2&63)+"="):f==1&&(u=r.charCodeAt(m),g+=p.charAt(u>>2)+p.charAt(u<<4&63)+"=="),g},I={encode:le,decode:re,version:"1.0.0"};if(l&&!l.nodeType)if(a)a.exports=I;else for(var _ in I)I.hasOwnProperty(_)&&(l[_]=I[_]);else s.base64=I})(V)})(v,v.exports);var S=v.exports;const K=(e,t,s=!1,l)=>{const i=`https://api.${s?"lob-staging":"lob"}.com/v1/us_autocompletions?valid_addresses=true&case=proper`,n={method:"POST",headers:{Authorization:`Basic ${S.encode(e+":")}`,"Content-Type":"application/json"},body:JSON.stringify(B({address_prefix:t},l))};return fetch(i,n)},Z=(e,t,s,l=!1,a)=>{const n=`https://api.${l?"lob-staging":"lob"}.com/v1/intl_autocompletions`,c={method:"POST",headers:{Authorization:`Basic ${S.encode(e+":")}`,"Content-Type":"application/json"},body:JSON.stringify(B({address_prefix:t,country:s},a))};return fetch(n,c)},q=(e,t,s=!1)=>{const l=typeof t=="string"?{address:t}:t,i=`https://api.${s?"lob-staging":"lob"}.com/v1/us_verifications`,n={method:"POST",headers:{Authorization:`Basic ${S.encode(e+":")}`,"Content-Type":"application/json"},body:JSON.stringify(l)};return fetch(i,n)},G=(e,t,s,l=!1)=>{const i=`https://api.${l?"lob-staging":"lob"}.com/v1/intl_verifications`,n={method:"POST",headers:{Authorization:`Basic ${S.encode(e+":")}`,"Content-Type":"application/json"},body:JSON.stringify({address:t,country:s})};return fetch(i,n)};var ue="";const X={emits:["onSuggestions","onError","onInput"],components:{TypeAhead:J},props:{address:{type:Object,default:{}},apiKey:{type:String},country:{type:String,default:"US"},isInternational:{type:Boolean,default:!1},isStaging:{type:Boolean,default:!1},placeholder:{type:String,default:"Search for an address"},minInputLength:{type:Number,default:1},primaryLineOnly:{type:Boolean,default:!1}},mounted(){this.$attrs.onSelectItem&&console.error("[@lob/vue-address-autocomplete] Event 'selectItem' has been removed for AddressAutocomplete, please use 'onSelect' instead"),this.$attrs.onNewSuggestions&&console.error("[@lob/vue-address-autocomplete] Event 'newSuggestions' has been removed for AddressAutocomplete, please use 'onSuggestions' instead")},data(){return{addresses:[],input:""}},methods:{formatSuggestions(e){const{primary_line:t,city:s,state:l,zip_code:a}=e.value;let i=0;this.input.split("").forEach(c=>{c.toLowerCase()===t.charAt(i).toLowerCase()&&(i+=1)});const n=i===0?`${t},`:i===t.length?`<strong>${t},</strong>`:`<span>
            <strong>${t.substring(0,i)}</strong>${t.substring(i)},
          </span>`;return{input:this.primaryLineOnly?t:`${t}, ${s}, ${l.toUpperCase()}, ${a}`,suggestion:`
          <span>
            ${n}
            <span style="color: #888;">
              ${s},&nbsp;${l.toUpperCase()},&nbsp;${a}
            </span>
          </span>
        `}},handleClickHeader(){window.location.href="https://www.lob.com/address-verification?utm_source=autocomplete&utm_medium=vue"},async onInput(e){this.selection=null,this.input=e.input,this.$emit("onInput",this.input);const t=await this.fetchFromAutocompleteAPI(e.input);this.addresses=t,this.$emit("onSuggestions",t),this.$forceUpdate()},async fetchFromAutocompleteAPI(e){if(!e)return[];if(this.isInternational&&e.length<3)return[];"primary_line"in this.address&&delete this.address.primary_line,"secondary_line"in this.address&&delete this.address.secondary_line;const s=await(this.isInternational?await Z(this.apiKey,e,this.country,this.isStaging):await K(this.apiKey,e,this.isStaging,this.address)).json();return s.error&&this.$emit("onError",s.error),(s.suggestions||[]).map(i=>({value:i,label:`${i.primary_line} ${i.city} ${i.state} ${i.zip_code}`}))},onBlur(e){this.input=e.input}}},E=e=>(o.pushScopeId("data-v-6fb6a3ce"),e=e(),o.popScopeId(),e),Q={class:"demo"},W={class:"row"},Y={class:"column column-60"},ee=[E(()=>o.createElementVNode("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1259 602",class:"lob-logo"},[o.createElementVNode("path",{d:"M1063,141c-47.06,0-89,18.33-121,50.78V0H780V338.74C765,222.53,666.88,138,540,138c-137,0-242,101-242,232a235,235,0,0,0,7.7,60H164V0H0V585H307l14.54-112.68C359.94,550,441.74,602,540,602c127.75,0,225.08-83.62,240-200.41V585H930V540.27c31.8,37,77.27,56.73,133,56.73,103,0,196-109,196-228C1259,239,1175,141,1063,141ZM540,450c-45,0-81-36-81-80s36-80,81-80c46,0,81,35,81,80S585,450,540,450Zm475-1c-46,0-83-36-83-80a82.8,82.8,0,0,1,82.6-83h.4c47,0,85,37,85,83C1100,413,1062,449,1015,449Z",fill:"#0099d7"})],-1)),E(()=>o.createElementVNode("span",{class:"lob-header"},"Deliverable addresses",-1)),E(()=>o.createElementVNode("a",{href:"https://www.lob.com/address-verification?utm_source=autocomplete&utm_medium=vue"},"Learn more",-1))];function te(e,t,s,l,a,i){const n=o.resolveComponent("TypeAhead");return o.openBlock(),o.createElementBlock("div",Q,[o.createElementVNode("div",W,[o.createElementVNode("div",Y,[o.createVNode(n,o.mergeProps({items:a.addresses,placeholder:s.placeholder,onOnInput:i.onInput,onOnBlur:i.onBlur,minInputLength:s.minInputLength,itemProjection:i.formatSuggestions,modelValue:a.input,"onUpdate:modelValue":t[2]||(t[2]=c=>a.input=c)},e.$attrs),{"list-header":o.withCtx(()=>[o.createElementVNode("div",{class:"lob-label",onClick:t[0]||(t[0]=(...c)=>i.handleClickHeader&&i.handleClickHeader(...c)),onMousedown:t[1]||(t[1]=o.withModifiers(()=>{},["prevent"]))},ee,32)]),_:1},16,["items","placeholder","onOnInput","onOnBlur","minInputLength","itemProjection","modelValue"])])])])}var C=T(X,[["render",te],["__scopeId","data-v-6fb6a3ce"]]);const k=e=>e.json().then(t=>"error"in t?Promise.reject(new Error(t.error.message)):t),oe=(e,t)=>Object.keys(t||{}).length?e.length?q(e,t).then(k):Promise.reject(new Error("Missing API key")):Promise.reject(new Error("Empty address was passed to verify function")),ne=(e,t,s)=>Object.keys(t||{}).length?e.length?typeof s!="string"?Promise.reject(new Error("Expected countryCode to be of type string")):/[A-Z]{2}/.test(s)===!1?Promise.reject(new Error("countryCode must be a 2 letter country short-name code (ISO 3166)")):G(e,t,s).then(k):Promise.reject(new Error("Missing API key")):Promise.reject(new Error("Empty address was passed to verify function"));function A(e){A.installed||(A.installed=!0,e.component("AddressAutocomplete",C))}const se={install:A};let $;typeof window!="undefined"?$=window.Vue:typeof global!="undefined"&&($=global.Vue),$&&$.use(se),C.install=A,d.default=C,d.verify=oe,d.verifyInternational=ne,Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
